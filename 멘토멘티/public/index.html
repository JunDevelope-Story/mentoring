<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>나만의 프로젝트</title>
</head>

<body>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.7.0/firebase-storage.js"></script>

    <div class="container">
        <header>
            <div class="logo">
                <h1>My Projects</h1>
            </div>
            <button id="addproject" onclick="location.href='edit.html'">프로젝트 추가</button>
        </header>

        <main id="project-container">

        </main>
    </div>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-storage.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA2_b3XG66cWEiqVwn66NWxalAumyida9w",
            authDomain: "mentoring-ee667.firebaseapp.com",
            projectId: "mentoring-ee667",
            storageBucket: "mentoring-ee667.appspot.com",
            messagingSenderId: "989832827250",
            appId: "1:989832827250:web:0b8923b0c805681b5b4deb"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore();
        const storage = getStorage();

        const projectContainer = document.getElementById('project-container');

        async function fetchProjects() {
            const querySnapshot = await getDocs(collection(db, 'product'));
            const projects = [];
            querySnapshot.forEach((doc) => {
                projects.push({ ...doc.data(), id: doc.id });
            });
            return projects;
        }

        async function renderProjects() {
            const projects = await fetchProjects();

            projects.forEach((project) => {
                const projectBox = document.createElement('div');
                projectBox.className = 'projectbox';

                const linkElement = document.createElement('a');
                linkElement.href = project.link;
                linkElement.target = '_blank';

                const imageElement = document.createElement('img');
                imageElement.className = 'projectimage';
                imageElement.src = project.fileURL;
                imageElement.alt = project.title;
                imageElement.style.maxWidth = '200px';
                imageElement.style.maxHeight = '200px';

                const titleElement = document.createElement('h2');
                titleElement.textContent = project.title;

                const descriptionElement = document.createElement('p');
                descriptionElement.textContent = project.content;

                const creatorElement = document.createElement('p');
                creatorElement.innerHTML = `<strong>창작자:</strong> ${project.name}`;

                // No need for uploadDateElement

                linkElement.appendChild(imageElement);
                projectBox.appendChild(titleElement);
                projectBox.appendChild(linkElement);
                projectBox.appendChild(descriptionElement);
                projectBox.appendChild(creatorElement);

                projectContainer.appendChild(projectBox);
            });
        }

        renderProjects();
    </script>
</body>

</html>
